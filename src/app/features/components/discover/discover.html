<section>
  @for(movie of allMovies(); track movie.id; let i=$index) {
  <a routerLink="/movie/{{movie.id}}">
    <img
      [src]="'https://image.tmdb.org/t/p/w500' + movie?.poster_path"
      [alt]="movie.title"
    />

    <div class="card-content">
      <div class="card-info">
        <ul>
          <li>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
              role="presentation"
            >
              <path
                d="M12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72 3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18-1.1 4.72c-.2.86.73 1.54 1.49 1.08l4.15-2.5z"
              ></path>
            </svg>
          </li>
          <li>
            <div>{{movie.vote_average.toFixed(1)}}</div>
          </li>
          <li class="favourite">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="#64b5f6"
              role="presentation"
            >
              <path
                d="M22.724 8.217l-6.786-.587-2.65-6.22c-.477-1.133-2.103-1.133-2.58 0l-2.65 6.234-6.772.573c-1.234.098-1.739 1.636-.8 2.446l5.146 4.446-1.542 6.598c-.28 1.202 1.023 2.153 2.09 1.51l5.818-3.495 5.819 3.509c1.065.643 2.37-.308 2.089-1.51l-1.542-6.612 5.145-4.446c.94-.81.45-2.348-.785-2.446zm-10.726 8.89l-5.272 3.174 1.402-5.983-4.655-4.026 6.141-.531 2.384-5.634 2.398 5.648 6.14.531-4.654 4.026 1.402 5.983-5.286-3.187z"
              ></path>
            </svg>
          </li>
        </ul>

        <h3>{{i}}.{{movie.title}}</h3>
      </div>

      <div class="card-actions">
        <div class="card-actions">
          <a mat-button class="btn-watchlist">
            <mat-icon>add</mat-icon>
            <span>Watchlist</span>
          </a>

          <a mat-button class="btn-trailer">
            <mat-icon>play_arrow</mat-icon>
            <span>Trailer</span>
          </a>
        </div>
      </div>
    </div>
  </a>
  } @empty {
  <div>There are no movies</div>
  } @if (isLoading() && allMovies().length === 0) {
  <div>Carregant pel·licules...</div>
  } @else if (isLoading() && allMovies().length > 0) {
  <div class="loading-more">
    <div class="spinner"></div>
    <p>Carregant més pel·licules...</p>
  </div>
  }
</section>

@if (canLoadMore() && !isLoading()) {
<div
  infiniteScroll
  [infiniteScrollDistance]="2"
  [infiniteScrollThrottle]="1000"
  (scrolled)="loadMore()"
></div>
}
